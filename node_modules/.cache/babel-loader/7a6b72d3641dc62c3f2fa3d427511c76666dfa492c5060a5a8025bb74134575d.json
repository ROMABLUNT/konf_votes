{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useSelector,useDispatch}from'react-redux';import{useParams,useNavigate}from'react-router-dom';import{fetchMembers}from'../../store/slices/membersSlice';import{fetchReactionCounts}from'../../store/slices/resultsSlice';import'./ResultsPage.scss';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const emojiMap={1:'üëç',2:'üëè',3:'‚ù§Ô∏è',4:'üéâ'};const ResultsPage=()=>{const{id}=useParams();const dispatch=useDispatch();const navigate=useNavigate();const{members}=useSelector(state=>state.members);const resultsState=useSelector(state=>state.results||{});const results=resultsState.results||{};const[loadingResults,setLoadingResults]=useState(true);useEffect(()=>{dispatch(fetchMembers(id));},[id,dispatch]);const fetchResults=async()=>{if(members.length>0){await Promise.all(members.map(async member=>{await dispatch(fetchReactionCounts(member.id)).unwrap();}));setLoadingResults(false);}};useEffect(()=>{fetchResults();const interval=setInterval(fetchResults,2000);return()=>clearInterval(interval);},[members,dispatch]);if(loadingResults)return/*#__PURE__*/_jsx(\"div\",{children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0430 \\u0440\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u043E\\u0432...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"results-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\u0420\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u044B \\u0433\\u043E\\u043B\\u043E\\u0441\\u043E\\u0432\\u0430\\u043D\\u0438\\u044F\"}),members.map(member=>/*#__PURE__*/_jsxs(\"div\",{className:\"member-results\",children:[/*#__PURE__*/_jsx(\"h2\",{children:member.member_name}),/*#__PURE__*/_jsx(\"p\",{children:member.speech_theme}),/*#__PURE__*/_jsxs(\"div\",{className:\"reaction-results\",children:[(Array.isArray(results[member.id])?results[member.id]:[]).map(_ref=>{let{reaction_id,r_count}=_ref;return/*#__PURE__*/_jsxs(\"div\",{className:\"reaction-item\",children:[emojiMap[reaction_id],\" \",r_count]},reaction_id);}),(!results[member.id]||results[member.id].length===0)&&/*#__PURE__*/_jsx(\"p\",{children:\"\\u041D\\u0435\\u0442 \\u0433\\u043E\\u043B\\u043E\\u0441\\u043E\\u0432\"})]})]},member.id)),/*#__PURE__*/_jsx(\"button\",{className:\"results-button\",onClick:()=>navigate(\"/conference/\".concat(id)),children:\"\\u0412\\u0435\\u0440\\u043D\\u0443\\u0442\\u044C\\u0441\\u044F \\u043A \\u043A\\u043E\\u043D\\u0444\\u0435\\u0440\\u0435\\u043D\\u0446\\u0438\\u0438\"})]});};export default ResultsPage;","map":{"version":3,"names":["React","useEffect","useState","useSelector","useDispatch","useParams","useNavigate","fetchMembers","fetchReactionCounts","jsx","_jsx","jsxs","_jsxs","emojiMap","ResultsPage","id","dispatch","navigate","members","state","resultsState","results","loadingResults","setLoadingResults","fetchResults","length","Promise","all","map","member","unwrap","interval","setInterval","clearInterval","children","className","member_name","speech_theme","Array","isArray","_ref","reaction_id","r_count","onClick","concat"],"sources":["C:/Roma/repositories/konf_votes/src/components/ResultsPage/ResultsPage.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport { fetchMembers } from '../../store/slices/membersSlice';\r\nimport { fetchReactionCounts } from '../../store/slices/resultsSlice';\r\nimport './ResultsPage.scss';\r\n\r\nconst emojiMap = {\r\n  1: 'üëç',\r\n  2: 'üëè',\r\n  3: '‚ù§Ô∏è',\r\n  4: 'üéâ',\r\n};\r\n\r\nconst ResultsPage = () => {\r\n  const { id } = useParams();\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const { members } = useSelector((state) => state.members);\r\n  const resultsState = useSelector((state) => state.results || {}); \r\n  const results = resultsState.results || {}; \r\n\r\n  const [loadingResults, setLoadingResults] = useState(true);\r\n\r\n  useEffect(() => {\r\n    dispatch(fetchMembers(id));\r\n  }, [id, dispatch]);\r\n\r\n  const fetchResults = async () => {\r\n    if (members.length > 0) {\r\n      await Promise.all(\r\n        members.map(async (member) => {\r\n          await dispatch(fetchReactionCounts(member.id)).unwrap();\r\n        })\r\n      );\r\n      setLoadingResults(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchResults(); \r\n    const interval = setInterval(fetchResults, 2000); \r\n    return () => clearInterval(interval); \r\n  }, [members, dispatch]);\r\n\r\n  if (loadingResults) return <div>–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤...</div>;\r\n\r\n  return (\r\n    <div className=\"results-container\">\r\n      <h1>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è</h1>\r\n      {members.map((member) => (\r\n        <div key={member.id} className=\"member-results\">\r\n          <h2>{member.member_name}</h2>\r\n          <p>{member.speech_theme}</p>\r\n          <div className=\"reaction-results\">\r\n            {(Array.isArray(results[member.id]) ? results[member.id] : []).map(({ reaction_id, r_count }) => (\r\n              <div key={reaction_id} className=\"reaction-item\">\r\n                {emojiMap[reaction_id]} {r_count}\r\n              </div>\r\n            ))}\r\n            {(!results[member.id] || results[member.id].length === 0) && <p>–ù–µ—Ç –≥–æ–ª–æ—Å–æ–≤</p>}\r\n          </div>\r\n        </div>\r\n      ))}\r\n      <button className=\"results-button\" onClick={() => navigate(`/conference/${id}`)}>\r\n        –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü–∏–∏\r\n      </button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ResultsPage;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAClD,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,OAASC,SAAS,CAAEC,WAAW,KAAQ,kBAAkB,CACzD,OAASC,YAAY,KAAQ,iCAAiC,CAC9D,OAASC,mBAAmB,KAAQ,iCAAiC,CACrE,MAAO,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5B,KAAM,CAAAC,QAAQ,CAAG,CACf,CAAC,CAAE,IAAI,CACP,CAAC,CAAE,IAAI,CACP,CAAC,CAAE,IAAI,CACP,CAAC,CAAE,IACL,CAAC,CAED,KAAM,CAAAC,WAAW,CAAGA,CAAA,GAAM,CACxB,KAAM,CAAEC,EAAG,CAAC,CAAGV,SAAS,CAAC,CAAC,CAC1B,KAAM,CAAAW,QAAQ,CAAGZ,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAa,QAAQ,CAAGX,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAEY,OAAQ,CAAC,CAAGf,WAAW,CAAEgB,KAAK,EAAKA,KAAK,CAACD,OAAO,CAAC,CACzD,KAAM,CAAAE,YAAY,CAAGjB,WAAW,CAAEgB,KAAK,EAAKA,KAAK,CAACE,OAAO,EAAI,CAAC,CAAC,CAAC,CAChE,KAAM,CAAAA,OAAO,CAAGD,YAAY,CAACC,OAAO,EAAI,CAAC,CAAC,CAE1C,KAAM,CAACC,cAAc,CAAEC,iBAAiB,CAAC,CAAGrB,QAAQ,CAAC,IAAI,CAAC,CAE1DD,SAAS,CAAC,IAAM,CACde,QAAQ,CAACT,YAAY,CAACQ,EAAE,CAAC,CAAC,CAC5B,CAAC,CAAE,CAACA,EAAE,CAAEC,QAAQ,CAAC,CAAC,CAElB,KAAM,CAAAQ,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAIN,OAAO,CAACO,MAAM,CAAG,CAAC,CAAE,CACtB,KAAM,CAAAC,OAAO,CAACC,GAAG,CACfT,OAAO,CAACU,GAAG,CAAC,KAAO,CAAAC,MAAM,EAAK,CAC5B,KAAM,CAAAb,QAAQ,CAACR,mBAAmB,CAACqB,MAAM,CAACd,EAAE,CAAC,CAAC,CAACe,MAAM,CAAC,CAAC,CACzD,CAAC,CACH,CAAC,CACDP,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CACF,CAAC,CAEDtB,SAAS,CAAC,IAAM,CACduB,YAAY,CAAC,CAAC,CACd,KAAM,CAAAO,QAAQ,CAAGC,WAAW,CAACR,YAAY,CAAE,IAAI,CAAC,CAChD,MAAO,IAAMS,aAAa,CAACF,QAAQ,CAAC,CACtC,CAAC,CAAE,CAACb,OAAO,CAAEF,QAAQ,CAAC,CAAC,CAEvB,GAAIM,cAAc,CAAE,mBAAOZ,IAAA,QAAAwB,QAAA,CAAK,wHAAuB,CAAK,CAAC,CAE7D,mBACEtB,KAAA,QAAKuB,SAAS,CAAC,mBAAmB,CAAAD,QAAA,eAChCxB,IAAA,OAAAwB,QAAA,CAAI,iIAAsB,CAAI,CAAC,CAC9BhB,OAAO,CAACU,GAAG,CAAEC,MAAM,eAClBjB,KAAA,QAAqBuB,SAAS,CAAC,gBAAgB,CAAAD,QAAA,eAC7CxB,IAAA,OAAAwB,QAAA,CAAKL,MAAM,CAACO,WAAW,CAAK,CAAC,cAC7B1B,IAAA,MAAAwB,QAAA,CAAIL,MAAM,CAACQ,YAAY,CAAI,CAAC,cAC5BzB,KAAA,QAAKuB,SAAS,CAAC,kBAAkB,CAAAD,QAAA,EAC9B,CAACI,KAAK,CAACC,OAAO,CAAClB,OAAO,CAACQ,MAAM,CAACd,EAAE,CAAC,CAAC,CAAGM,OAAO,CAACQ,MAAM,CAACd,EAAE,CAAC,CAAG,EAAE,EAAEa,GAAG,CAACY,IAAA,MAAC,CAAEC,WAAW,CAAEC,OAAQ,CAAC,CAAAF,IAAA,oBAC1F5B,KAAA,QAAuBuB,SAAS,CAAC,eAAe,CAAAD,QAAA,EAC7CrB,QAAQ,CAAC4B,WAAW,CAAC,CAAC,GAAC,CAACC,OAAO,GADxBD,WAEL,CAAC,EACP,CAAC,CACD,CAAC,CAACpB,OAAO,CAACQ,MAAM,CAACd,EAAE,CAAC,EAAIM,OAAO,CAACQ,MAAM,CAACd,EAAE,CAAC,CAACU,MAAM,GAAK,CAAC,gBAAKf,IAAA,MAAAwB,QAAA,CAAG,+DAAW,CAAG,CAAC,EAC5E,CAAC,GAVEL,MAAM,CAACd,EAWZ,CACN,CAAC,cACFL,IAAA,WAAQyB,SAAS,CAAC,gBAAgB,CAACQ,OAAO,CAAEA,CAAA,GAAM1B,QAAQ,gBAAA2B,MAAA,CAAgB7B,EAAE,CAAE,CAAE,CAAAmB,QAAA,CAAC,kIAEjF,CAAQ,CAAC,EACN,CAAC,CAEV,CAAC,CAED,cAAe,CAAApB,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}