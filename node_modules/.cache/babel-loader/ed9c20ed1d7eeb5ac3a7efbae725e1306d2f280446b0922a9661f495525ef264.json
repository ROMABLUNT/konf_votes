{"ast":null,"code":"import React,{useEffect,useState,useCallback}from'react';import{useSelector,useDispatch}from'react-redux';import{useParams}from'react-router-dom';import{fetchMembers}from'../../store/slices/membersSlice';import{sendVote}from'../../store/slices/votingSlice';import ConferencePage from'./ConferencePage';import{jsx as _jsx}from\"react/jsx-runtime\";const ConferencePageContainer=()=>{const{id}=useParams();const dispatch=useDispatch();const{members,status,error}=useSelector(state=>state.members);const[votesCount,setVotesCount]=useState(0);const[showResultsButton,setShowResultsButton]=useState(false);useEffect(()=>{dispatch(fetchMembers(id));},[id,dispatch]);const handleVote=useCallback((memberId,reaction)=>{const voteData={event_id:parseInt(id),member_id:parseInt(memberId),reaction_id:reaction};dispatch(sendVote(voteData));if(!localStorage.getItem(\"voted-\".concat(memberId))){localStorage.setItem(\"voted-\".concat(memberId),'true');setVotesCount(prev=>prev+1);}},[id,dispatch]);useEffect(()=>{const count=members.filter(member=>localStorage.getItem(\"voted-\".concat(member.id))==='true').length;setVotesCount(count);},[members]);useEffect(()=>{if(votesCount===members.length&&members.length>0){setShowResultsButton(true);}},[votesCount,members]);return/*#__PURE__*/_jsx(ConferencePage,{id:id,members:members,status:status,error:error,votesCount:votesCount,showResultsButton:showResultsButton,handleVote:handleVote});};export default ConferencePageContainer;","map":{"version":3,"names":["React","useEffect","useState","useCallback","useSelector","useDispatch","useParams","fetchMembers","sendVote","ConferencePage","jsx","_jsx","ConferencePageContainer","id","dispatch","members","status","error","state","votesCount","setVotesCount","showResultsButton","setShowResultsButton","handleVote","memberId","reaction","voteData","event_id","parseInt","member_id","reaction_id","localStorage","getItem","concat","setItem","prev","count","filter","member","length"],"sources":["C:/Roma/repositories/konf_votes/src/pages/Conference/ConferencePageContainer.jsx"],"sourcesContent":["import React, { useEffect, useState, useCallback } from 'react';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport { useParams } from 'react-router-dom';\r\nimport { fetchMembers } from '../../store/slices/membersSlice';\r\nimport { sendVote } from '../../store/slices/votingSlice';\r\nimport ConferencePage from './ConferencePage';\r\n\r\nconst ConferencePageContainer = () => {\r\n  const { id } = useParams(); \r\n  const dispatch = useDispatch();\r\n  const { members, status, error } = useSelector((state) => state.members);\r\n\r\n  const [votesCount, setVotesCount] = useState(0);\r\n  const [showResultsButton, setShowResultsButton] = useState(false);\r\n\r\n  useEffect(() => {\r\n    dispatch(fetchMembers(id)); \r\n  }, [id, dispatch]);\r\n\r\n  const handleVote = useCallback((memberId, reaction) => {\r\n    const voteData = {\r\n      event_id: parseInt(id),\r\n      member_id: parseInt(memberId),\r\n      reaction_id: reaction,\r\n    };\r\n\r\n    dispatch(sendVote(voteData));\r\n\r\n    if (!localStorage.getItem(`voted-${memberId}`)) {\r\n      localStorage.setItem(`voted-${memberId}`, 'true');\r\n      setVotesCount(prev => prev + 1);\r\n    }\r\n  }, [id, dispatch]);\r\n\r\n  useEffect(() => {\r\n    const count = members.filter(member => localStorage.getItem(`voted-${member.id}`) === 'true').length;\r\n    setVotesCount(count);\r\n  }, [members]);\r\n\r\n  useEffect(() => {\r\n    if (votesCount === members.length && members.length > 0) {\r\n      setShowResultsButton(true);\r\n    }\r\n  }, [votesCount, members]);\r\n\r\n  return (\r\n    <ConferencePage\r\n      id={id}  \r\n      members={members}\r\n      status={status}\r\n      error={error}\r\n      votesCount={votesCount}\r\n      showResultsButton={showResultsButton}\r\n      handleVote={handleVote}\r\n    />\r\n  );\r\n};\r\n\r\nexport default ConferencePageContainer;\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,CAAEC,WAAW,KAAQ,OAAO,CAC/D,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,OAASC,SAAS,KAAQ,kBAAkB,CAC5C,OAASC,YAAY,KAAQ,iCAAiC,CAC9D,OAASC,QAAQ,KAAQ,gCAAgC,CACzD,MAAO,CAAAC,cAAc,KAAM,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE9C,KAAM,CAAAC,uBAAuB,CAAGA,CAAA,GAAM,CACpC,KAAM,CAAEC,EAAG,CAAC,CAAGP,SAAS,CAAC,CAAC,CAC1B,KAAM,CAAAQ,QAAQ,CAAGT,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAEU,OAAO,CAAEC,MAAM,CAAEC,KAAM,CAAC,CAAGb,WAAW,CAAEc,KAAK,EAAKA,KAAK,CAACH,OAAO,CAAC,CAExE,KAAM,CAACI,UAAU,CAAEC,aAAa,CAAC,CAAGlB,QAAQ,CAAC,CAAC,CAAC,CAC/C,KAAM,CAACmB,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGpB,QAAQ,CAAC,KAAK,CAAC,CAEjED,SAAS,CAAC,IAAM,CACda,QAAQ,CAACP,YAAY,CAACM,EAAE,CAAC,CAAC,CAC5B,CAAC,CAAE,CAACA,EAAE,CAAEC,QAAQ,CAAC,CAAC,CAElB,KAAM,CAAAS,UAAU,CAAGpB,WAAW,CAAC,CAACqB,QAAQ,CAAEC,QAAQ,GAAK,CACrD,KAAM,CAAAC,QAAQ,CAAG,CACfC,QAAQ,CAAEC,QAAQ,CAACf,EAAE,CAAC,CACtBgB,SAAS,CAAED,QAAQ,CAACJ,QAAQ,CAAC,CAC7BM,WAAW,CAAEL,QACf,CAAC,CAEDX,QAAQ,CAACN,QAAQ,CAACkB,QAAQ,CAAC,CAAC,CAE5B,GAAI,CAACK,YAAY,CAACC,OAAO,UAAAC,MAAA,CAAUT,QAAQ,CAAE,CAAC,CAAE,CAC9CO,YAAY,CAACG,OAAO,UAAAD,MAAA,CAAUT,QAAQ,EAAI,MAAM,CAAC,CACjDJ,aAAa,CAACe,IAAI,EAAIA,IAAI,CAAG,CAAC,CAAC,CACjC,CACF,CAAC,CAAE,CAACtB,EAAE,CAAEC,QAAQ,CAAC,CAAC,CAElBb,SAAS,CAAC,IAAM,CACd,KAAM,CAAAmC,KAAK,CAAGrB,OAAO,CAACsB,MAAM,CAACC,MAAM,EAAIP,YAAY,CAACC,OAAO,UAAAC,MAAA,CAAUK,MAAM,CAACzB,EAAE,CAAE,CAAC,GAAK,MAAM,CAAC,CAAC0B,MAAM,CACpGnB,aAAa,CAACgB,KAAK,CAAC,CACtB,CAAC,CAAE,CAACrB,OAAO,CAAC,CAAC,CAEbd,SAAS,CAAC,IAAM,CACd,GAAIkB,UAAU,GAAKJ,OAAO,CAACwB,MAAM,EAAIxB,OAAO,CAACwB,MAAM,CAAG,CAAC,CAAE,CACvDjB,oBAAoB,CAAC,IAAI,CAAC,CAC5B,CACF,CAAC,CAAE,CAACH,UAAU,CAAEJ,OAAO,CAAC,CAAC,CAEzB,mBACEJ,IAAA,CAACF,cAAc,EACbI,EAAE,CAAEA,EAAG,CACPE,OAAO,CAAEA,OAAQ,CACjBC,MAAM,CAAEA,MAAO,CACfC,KAAK,CAAEA,KAAM,CACbE,UAAU,CAAEA,UAAW,CACvBE,iBAAiB,CAAEA,iBAAkB,CACrCE,UAAU,CAAEA,UAAW,CACxB,CAAC,CAEN,CAAC,CAED,cAAe,CAAAX,uBAAuB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}